// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Belt_Int = require("rescript/lib/js/belt_Int.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");
var Caml_exceptions = require("rescript/lib/js/caml_exceptions.js");
var Utils$AdventOfCode = require("../../Utils.bs.js");

function log(prim) {
  console.log(prim);
  
}

var InvalidMove = /* @__PURE__ */Caml_exceptions.create("AOC2021_Day2-AdventOfCode.Move.InvalidMove");

function make(s, n) {
  switch (s) {
    case "down" :
        return {
                TAG: /* Down */1,
                _0: n
              };
    case "forward" :
        return {
                TAG: /* Forward */0,
                _0: n
              };
    case "up" :
        return {
                TAG: /* Up */2,
                _0: n
              };
    default:
      throw {
            RE_EXN_ID: InvalidMove,
            _1: s,
            Error: new Error()
          };
  }
}

var Move = {
  InvalidMove: InvalidMove,
  make: make
};

var make$1 = {
  h: 0,
  d: 0
};

function move(t, move$1) {
  switch (move$1.TAG | 0) {
    case /* Forward */0 :
        return {
                h: t.h + move$1._0 | 0,
                d: t.d
              };
    case /* Down */1 :
        return {
                h: t.h,
                d: t.d + move$1._0 | 0
              };
    case /* Up */2 :
        return {
                h: t.h,
                d: t.d - move$1._0 | 0
              };
    
  }
}

var Submarine = {
  make: make$1,
  move: move
};

function run(xs) {
  return Belt_Array.reduce(xs, make$1, move);
}

function parse(data) {
  return Belt_Array.map(Utils$AdventOfCode.splitNewline(data), (function (x) {
                var s = x.trim().split(" ");
                return make(Belt_Option.getExn(Belt_Array.get(s, 0)), Belt_Option.getExn(Belt_Int.fromString(Belt_Option.getExn(Belt_Array.get(s, 1)))));
              }));
}

function answer(t) {
  return Math.imul(t.h, t.d);
}

function solvePart1(data) {
  return answer(run(parse(data)));
}

function solvePart2(data) {
  return 2;
}

exports.log = log;
exports.Move = Move;
exports.Submarine = Submarine;
exports.run = run;
exports.parse = parse;
exports.answer = answer;
exports.solvePart1 = solvePart1;
exports.solvePart2 = solvePart2;
/* No side effect */
