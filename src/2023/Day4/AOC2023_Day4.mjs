// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Core__Int from "@rescript/core/src/Core__Int.mjs";
import * as Belt_SetInt from "rescript/lib/es6/belt_SetInt.js";
import * as Core__Array from "@rescript/core/src/Core__Array.mjs";
import * as Core__Option from "@rescript/core/src/Core__Option.mjs";
import * as Utils$AdventOfCode from "../../Utils.mjs";

function log(prim) {
  console.log(prim);
}

function log2(prim0, prim1) {
  console.log(prim0, prim1);
}

function parse(data) {
  return Utils$AdventOfCode.splitNewline(data).map(function (l) {
              var cardAndNumbers = l.trim().split(": ");
              var cardId = Core__Option.flatMap(cardAndNumbers[0], (function (s) {
                      return Core__Int.fromString(undefined, s.replace("Card ", ""));
                    }));
              var numberStrs = Core__Option.flatMap(cardAndNumbers[1], (function (s) {
                      return s.split(" | ").map(function (nums) {
                                  var partial_arg = 10;
                                  return Core__Array.filterMap(nums.trim().split(" "), (function (param) {
                                                return Core__Int.fromString(partial_arg, param);
                                              }));
                                });
                    }));
              return {
                      id: Core__Option.getExn(cardId),
                      winners: Core__Option.getExn(Core__Option.flatMap(numberStrs, (function (__x) {
                                  return __x.at(0);
                                }))),
                      actuals: Core__Option.getExn(Core__Option.flatMap(numberStrs, (function (__x) {
                                  return __x.at(1);
                                })))
                    };
            });
}

function part1(cards) {
  return Utils$AdventOfCode.sumIntArray(cards.map(function (param) {
                  var winnerSet = Belt_SetInt.fromArray(param.winners);
                  var actualsSet = Belt_SetInt.fromArray(param.actuals);
                  var match = Belt_SetInt.intersect(winnerSet, actualsSet);
                  var prim1 = Belt_SetInt.toArray(match);
                  console.log("match", prim1);
                  var nMatches = Belt_SetInt.size(match);
                  if (nMatches === 0) {
                    return 0;
                  } else {
                    return Math.pow(2, nMatches - 1 | 0);
                  }
                }));
}

function solvePart1(data) {
  var prim = part1(parse(data));
  console.log(prim);
  return 1;
}

function solvePart2(data) {
  return 2;
}

export {
  log ,
  log2 ,
  parse ,
  part1 ,
  solvePart1 ,
  solvePart2 ,
}
/* No side effect */
