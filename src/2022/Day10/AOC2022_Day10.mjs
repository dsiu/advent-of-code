// Generated by ReScript, PLEASE EDIT WITH CARE

import * as JsArray2Ex from "js-array2-ex/src/JsArray2Ex.mjs";
import * as Pervasives from "rescript/lib/es6/pervasives.js";
import * as Caml_format from "rescript/lib/es6/caml_format.js";
import * as Stdlib_Array from "@dsiu/rescript-stdlib-fp/src/Stdlib_Array.mjs";
import * as Utils$AdventOfCode from "../../Utils.mjs";

function log(prim) {
  console.log(prim);
}

function applyOp(op) {
  if (typeof op !== "object") {
    return [0];
  } else {
    return [
            0,
            op._0
          ];
  }
}

function apply(ops) {
  var len = (Stdlib_Array.length(ops) << 1);
  return Stdlib_Array.zip(Stdlib_Array.makeBy(len, (function (x) {
                    return x + 1 | 0;
                  })), Stdlib_Array.scanl(Stdlib_Array.flatMap(ops, applyOp), 1, (function (prim0, prim1) {
                    return prim0 + prim1 | 0;
                  })));
}

function extractSignals(signals) {
  return Stdlib_Array.filter(signals, (function (param) {
                return (param[0] + 20 | 0) % 40 === 0;
              }));
}

function calculateSixSignals(signals) {
  return Utils$AdventOfCode.sumIntArray(Stdlib_Array.filterMap(signals, (function (param) {
                    var t = param[0];
                    if (t <= 220) {
                      return Math.imul(t, param[1]);
                    }
                    
                  })));
}

function part1(param) {
  return Utils$AdventOfCode.compose(extractSignals, calculateSixSignals, param);
}

function showPixel(b) {
  if (b) {
    return "â–ˆ";
  } else {
    return " ";
  }
}

function columnOf(n) {
  return (n - 1 | 0) % 40;
}

function isLit(param) {
  var c = columnOf(param[0]);
  return Pervasives.abs(param[1] - c | 0) <= 1;
}

function part2(regVals) {
  var pixels = Stdlib_Array.map(regVals, (function (param) {
          return Utils$AdventOfCode.compose(isLit, showPixel, param);
        }));
  return Stdlib_Array.map(JsArray2Ex.chunkBySize(pixels, 40), (function (x) {
                return x.join("");
              }));
}

function parse(data) {
  return Stdlib_Array.map(Utils$AdventOfCode.splitNewline(data), (function (x) {
                var l = x.trim();
                if (l.startsWith("noop")) {
                  return "Noop";
                }
                var match = l.split(" ");
                if (match.length !== 2) {
                  throw {
                        RE_EXN_ID: "Match_failure",
                        _1: [
                          "AOC2022_Day10.res",
                          63,
                          14
                        ],
                        Error: new Error()
                      };
                }
                var v = match[1];
                return {
                        TAG: "Addx",
                        _0: Caml_format.int_of_string(v)
                      };
              }));
}

function solvePart1(data) {
  return Utils$AdventOfCode.compose(extractSignals, calculateSixSignals, apply(parse(data)));
}

function solvePart2(data) {
  var prim = part2(apply(parse(data)));
  console.log(prim);
  return "EFGERURE";
}

var A;

export {
  log ,
  A ,
  applyOp ,
  apply ,
  extractSignals ,
  calculateSixSignals ,
  part1 ,
  showPixel ,
  columnOf ,
  isLit ,
  part2 ,
  parse ,
  solvePart1 ,
  solvePart2 ,
}
/* Stdlib_Array Not a pure module */
